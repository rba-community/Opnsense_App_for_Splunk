{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"Step 1<pre><code>    Install and configure OPNsense Add-on for Splunk\n</code></pre> <ul> <li>Complete logging prerequisites</li> <li>Install on Indexers, Search Heads</li> <li>Configure inputs</li> </ul> <p>See Documentation  View on Splunkbase</p> Step 2<pre><code>    Install and configure OPNsense App for Splunk\n</code></pre> <p></p> <ul> <li>Install dependencies</li> <li>Install only on Search Heads</li> <li>(recommended) Configure app</li> </ul> <p>See Documentation  View on Splunkbase</p>"},{"location":"landing-page/","title":"OPNsense App (Opnsense_App_for_Splunk)","text":"<p>Disclaimer</p> <p>This Splunk App is community driven and not affiliated with the official OPNsense\u00ae Firewall. As such, the included documentation does not contain information on how to get started with this firewall. Rather, this documentation serves as a guide to help visualize the data in Splunk. Please visit https://opnsense.org/ for documentation on installing/configuring your own OPNsense firewall.</p> <p>The OPNsense App for Splunk helps make your firewall data meaningful. Visualize system or security related events recorded by the OPNsense\u00ae Firewall. This app requires the OPNsense Add-on for Splunk.</p>"},{"location":"landing-page/#key-features","title":"Key Features","text":"<ul> <li>See system information including packages, plugins, and available updates.</li> <li>Better manage your Splunk license with a view to help identify the impact of the OPNsense data volume.</li> <li>Analyze traffic patterns and help troubleshoot issues.</li> <li>Visualize VPN traffic and look for suspicious connections.</li> </ul>"},{"location":"landing-page/#assumptions","title":"Assumptions","text":"<p>This documentation assumes the following:</p> <ol> <li>You have a working OPNsense firewall.</li> <li>You have a working Splunk environment.</li> <li>Basic understanding of Splunk and OPNsense.</li> <li>The OPNsense Add-on for Splunk has been installed and configured.</li> </ol>"},{"location":"landing-page/#about","title":"About","text":"Info Description Version 1.1.3 - Splunkbase | GitHub Vendor Product Version OPNsense\u00ae 22.x <p>Get Started</p>"},{"location":"getting-started/app-dependencies/","title":"App Dependencies","text":"<p>The following table describes the Add-ons that are needed to utilize the full capabilities of the app. Please install and configure these apps prior to deploying this app.</p> <p>Danger, Will Robinson</p> <p>Failure to install any of the below apps/add-ons will cause this app to not function as intended.</p> Splunkbase Add-on Version Description OPNsense Add-on (TA-opnsense) &gt;= 1.5.0 Technical Add-on needed for Splunk to correctly parse the OPNsense firewall data. Splunk Common Information Model &gt;= 4.0.0 The Splunk CIM normalizes the data into datamodels which this app leverages for performance."},{"location":"getting-started/where-to-install/","title":"Where to Install","text":""},{"location":"getting-started/where-to-install/#standalone-deployments","title":"Standalone Deployments","text":"<p>Install this app to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment</p>"},{"location":"getting-started/where-to-install/#distributed-deployments","title":"Distributed Deployments","text":"Splunk Instance type Supported Required Comments Search Heads Yes Yes Install this app on search heads. Indexers No No This app does not require installation on indexers. Heavy Forwarders No No There is no need to install this app on Heavy Forwarders. Universal Forwarders No No This app should not be installed on Universal Forwarders. <p>The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment</p>"},{"location":"getting-started/configure/configure-dma/","title":"Data Model Acceleration","text":"<p>Optional</p> <p>Enabling Data model acceleration (DMA) will allow the searches to perform much more efficiently for larger datasets. If you run into issues with dashboards taking too long to load, data model acceleration will increase performance with a slight increase to resource usage. To learn more about data model acceleration see Splunk Docs: Accelerate data models.</p>"},{"location":"getting-started/configure/configure-dma/#enable-acceleration","title":"Enable Acceleration","text":"<p>Before enabling Data model acceleration, ensure the index being used for the OPNsense data has been allowed on the CIM add-on list of indexes.</p> <ol> <li>In Splunk web, Navigate to Apps &gt; Manage Apps.</li> <li>Find the App \"Splunk Common Information Model\" and click <code>set up</code> on the right side.</li> <li> <p>For each of the models being used, whitelist the appropriate indexes. For more information on the data models used by this app/add-on see OPNsense Add-on sourcetype reference.</p> <ul> <li>This will allow only the indexes listed to be accelerated. If you are ingesting data into other indexes and also want them to be included in the acceleration, list them here as well.</li> </ul> Tip <p>To identify which indexes are being used by the CIM, the following query can be run:</p> <pre><code>| multisearch\n    [| tstats summariesonly=f prestats=t count from datamodel=Authentication by index\n    | eval datamodel=\"Authentication\"]\n[| tstats summariesonly=f prestats=t count from datamodel=Web by index\n    | eval datamodel=\"Web\"]\n[| tstats summariesonly=f prestats=t count from datamodel=Network_Sessions by index\n    | eval datamodel=\"Network_Sessions\"]\n[| tstats summariesonly=f prestats=t count from datamodel=Network_Resolution by index\n    | eval datamodel=\"Network_Resolution\"]\n[| tstats summariesonly=f prestats=t count from datamodel=Intrusion_Detection by index\n    | eval datamodel=\"Intrusion_Detection\"]\n[| tstats summariesonly=f prestats=t count from datamodel=Network_Traffic by index\n    | eval datamodel=\"Network_Traffic\"]\n| stats count by index datamodel\n| stats values(index) as indexes by datamodel\n| eval indexes=mvjoin(indexes, \",\")\n</code></pre> <p>Notice that this data searches for all data and not just the OPNsense data. Modify the search as needed.</p> </li> <li> <p>Once the appropriate indexes are listed, check the \"Accelerate\" box at the top and save.</p> </li> <li>The data model will begin to build. This may take some time depending on the size.</li> <li>Update the <code>opnsense_summariesonly</code> macro to <code>summariesonly=true</code>. Setting this will force the dashboards to use accelerated data only, optimizing the searches. see Update Macros in this documentation for more information.</li> </ol>"},{"location":"getting-started/configure/configure-macros/","title":"Update Search Macros","text":"<p>Recommended Step</p> <p>To ensure this App functions efficiently, it is important to update a few search macros. Change the following macros to their appropriate values. For more information on the search macros used in this app, see Search Macros Reference.</p>"},{"location":"getting-started/configure/configure-macros/#how-to-update-macros","title":"How to Update Macros","text":"<ol> <li>Open the OPNsense app for Splunk.</li> <li> <p>Navigate to Settings &gt; Advanced Search &gt; Search macros.</p> Not seeing any results <p>If no results are found, be sure that the \"App\" context is set to the OPNsense app, owner is set to \"Any\", and choose \"Created in the App\" from the remaining drop-down.</p> </li> <li> <p>Click the macro name to modify.</p> </li> </ol>"},{"location":"getting-started/configure/configure-macros/#update-index-macros","title":"Update Index Macros","text":"<p>Update the index specific macros to the indexes being used for the OPNsense data. Updating these to the correct values will increase performance of searches.</p> Macro Default Description Example Value opnsense_system_index index=* Update to the specific index being used for the opnsense:system sourcetype created from the System modular input. see OPNsense Add-on: Modular Inputs <code>index=netfwsystem</code>"},{"location":"getting-started/configure/configure-macros/#update-search-related-macros","title":"Update Search Related Macros","text":"<p>Update this search macro only if you are using DMA. see Configure Data Model Acceleration for more information.</p> <p>Warning</p> <p>Updating this macro to \"true\" without first enabling data model acceleration will cause the searches in dashboards to fail or show no results.</p> Macro Default Description Example Value opnsense_summariesonly summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. <code>summariesonly=true</code>"},{"location":"reference/reference-macros/","title":"Search Macro Reference","text":"Macro Default Description <code>opnsense_comment(1)</code> \"\" Ability to set comments within the App. This is no longer required as of Splunk 8.1 and three back ticks may be used. See Splunk Docs: Adding Comments for more information. <code>opnsense_summariesonly</code> summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. <code>opnsense_system_index</code> index=* Update to the specific index being used for the opnsense:system sourcetype created from the System modular input. see OPNsense Add-on: Modular Inputs <code>opnsense_tstats</code> tstats `opnsense_summariesonly` prestats=true Used by dashboards within this app. Modifying this macro will impact dashboards from loading searches properly. <code>opnsense_local_ip(1)</code> $ip_field$ IN(10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 224.0.0.0/4) Used by dashboards within this app to find local IPs. <code>opnsense_trunk(2)</code> eval $t_field$=if(mvcount($t_field$)&gt;$t_num$, mvappend(mvindex($t_field$, 0, $t_num$-1), \"..Truncated..\"), $t_field$) Truncates multivalued fields based off the integer passed to the macro. <code>opnsense_ctime(1)</code> convert timeformat=\"%F %T %Z\" ctime($utime$) Converts unix timestamp into human readable format."},{"location":"reference/reference-searches/","title":"Scheduled Search Reference","text":"<p>This app utilizes saved searches to populates dashboards. The following table describes the searches used.</p> Search Name Cron Schedule Enabled by Default OPNsense - License Usage Overview 2 3 * * * True"},{"location":"reference/releases/","title":"Release notes for the OPNsense app for Splunk","text":""},{"location":"reference/releases/#v113-september-15-2022","title":"v1.1.3 September 15, 2022","text":""},{"location":"reference/releases/#fixes","title":"Fixes","text":"<ul> <li>Fixed plugin panel on System Overview dashboard (#8).</li> </ul>"},{"location":"reference/releases/#known-issues","title":"Known issues","text":"<p>This version of the OPNsense app for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the OPNsense app for Splunk's Github page.</p>"},{"location":"reference/releases/release-history/","title":"Release history for the OPNsense app for Splunk","text":"<p>The latest version of the OPNsense app for Splunk is version 1.1.3. See Release notes for the OPNsense app for Splunk of the latest version.</p>"},{"location":"reference/releases/release-history/#v112-march-20-2022","title":"v1.1.2 March 20, 2022","text":""},{"location":"reference/releases/release-history/#new-features","title":"New features","text":"<ul> <li>added search macro for local IPs.</li> <li>added search macro for truncating multi-valued fields.</li> <li>added search macro for converting unix timestamps.</li> <li>lookup file added for standard actions and transports.</li> <li>Dashboards: Traffic Search, IDS Search</li> <li>All dashboards now in dark mode by default.</li> </ul>"},{"location":"reference/releases/release-history/#updated","title":"Updated","text":"<ul> <li>Added top signatures panel to IDS overview dashboard.</li> <li>Added drilldowns for Traffic and IDS overview dashboards</li> </ul>"},{"location":"reference/releases/release-history/#v111-sept-18-2021","title":"v1.1.1 Sept 18, 2021","text":"<ul> <li>Added version to dashboards to support jQuery v3.5.</li> <li>Converted License Overview panel on Data overview dashboard to be schedule report.</li> </ul>"},{"location":"reference/releases/release-history/#v110-may-28-2021","title":"v1.1.0 May 28, 2021","text":"<ul> <li>Added version to dashboards to support jQuery v3.5.</li> <li>Converted License Overview panel on Data overview dashboard to be schedule report.</li> </ul>"},{"location":"reference/releases/release-history/#v110-may-28-2021_1","title":"v1.1.0 May 28, 2021","text":"<ul> <li>Added System Dashboard. This is powered by the modular input from the Add-on.</li> <li>Added host filters on all dashboards.</li> <li>Updated IDS Overview dashboard to include the time of latest intrusion event.</li> </ul>"},{"location":"reference/releases/release-history/#v100-dec-14-2020","title":"v1.0.0 Dec 14, 2020","text":"<ul> <li>Initial Release.</li> </ul>"}]}